

# [visual saliency prediction with adversarial networks](https://arxiv.org/pdf/1701.01081.pdf)（用对抗网络预测视觉显着性）

## 针对问题

1. 用于显着性预测的最近方法通常基于单个显着性度量以损失函数进行训练。 在使用其他显着性指标进行评估时，这可能会导致性能下降。
2. 不同显著性度量在显著性映射的定义上存在分歧。
3. 探索使用这种对抗性损失的好处。

## 模型结构

SalGAN使用深度卷积神经网络（DCNN）估计输入图像的显着性图。该网络最初在显着图的下采样版本上以二分类交叉熵（BCE）损失进行训练。 然后使用经过训练的鉴别器网络对该模型进行细化，以解决由SalGAN生成的显着图与用作基础事实的真实图之间的二元分类任务。
![ExDepV.png](https://s2.ax1x.com/2019/05/20/ExDepV.png)

### 生成器

生成器网络采用卷积编解码器架构，其中编码器部分包括最大池化层，可减小特征映射的大小，解码器部分使用上采样层和卷积滤波器构造与输入分辨率相同的输出。

网络的编码器部分在架构上与VGG-16相同，省略了最后的池化和完全连接的层。在进行显著性预测训练时，只对VGG-16中的最后两组卷积层进行了修改，而前三组卷积层与原始VGG-16模型保持不变。

解码器体系结构的结构与编码器相同，但是层的顺序颠倒了，池层被上采样层取代。在所有卷积层中使用ReLU非线性激活，并添加最后一个具有sigmoid的$1\times1$个卷积层来生成显著性映射。解码器的权值是随机初始化的。网络的最终输出是与输入图像大小相同的显著性映射。

### 判别器

判别器网络由6个$3\times3$内核卷积组成，中间穿插着3个池化层，然后是3个完全连接的层。卷积层都使用ReLU激活，而完全连接层使用tanh激活，除了最后一层使用sigmoid激活。

### 和GAN的区别

首先，目标是拟合一个确定性函数，从图像中预测现实的显著性值，而不是从随机噪声中预测现实的图像。输入到生成器(显著性预测网络)的不是随机噪声，而是图像。其次，显著性映射对应的输入图像是必不可少的，因为目标不仅是使这两个显著性映射变得不可分辨，而且还要满足它们都对应同一输入图像的条件。因此，将图像和显著性映射都包含到鉴别器网络中。

### 损失函数

交叉熵损失函数：
$$
\mathcal{L}_{B C E}=-\frac{1}{N} \sum_{j=1}^{N}\left(S_{j} \log \left(\hat{S}_{j}\right)+\left(1-S_{j}\right) \log \left(1-\hat{S}_{j}\right)\right)
$$
在对生成函数的参数进行更新时，我们发现使用一个损失函数，即判别器的误差与交叉熵相对于地面真实值的组合，提高了对抗性训练的稳定性和收敛速度。对抗性训练中显著性预测网络的最终损失函数可表示为
$$
\mathcal{L}=\alpha \cdot \mathcal{L}_{B C E}+L(D(I, \hat{S}), 1)
$$
其中$L$为二元交叉熵损失，1为真实样本的目标类别，0为虚假(预测)样本类别。这里，不是最小化$-L(D(I, S), 0)$，而是优化具有更强的梯度的$L(D(I, S), 1)$，$D(I, \hat{S})$为欺骗判别器网络的概率，当欺骗判别器的概率越低时，显著性预测网络的损失越大。在识别器的训练过程中，没有内容丢失，丢失函数为：
$$
\mathcal{L}_{\mathcal{D}}=L(D(I, S), 1)+L(D(I, \hat{S}), 0)
$$
在训练时，首先使用BCE训练15个epochs来引导显著性预测网络函数，该函数是根据下采样输出和地面真值显著性来计算的。在此之后，再添加了判别器并开始了对抗性训练。识别器网络的输入是一个大小为$256\times192\times4$的RGB图像，包含源图像通道和(预测或地面真值)显著性。

## 思考

其实我觉得GAN的关键还是在于生成器和判别器的设计上面。文中只是用实验说明了用四次下采样效果更好，而其他的设计是没有说服力的。

### 好的地方

1. 如文中所说，好像的确是第一个用GAN做显著性检测的。
2. 为了克服配对的问题，把图像融合成了4通道。。。。。。。

### 没看懂的地方

1. 文中的显著性检测，并不是非黑即白的图像，而是像热度图一样的东西，跟我理解的显著性检测不太一样
2. 而且他的评价指标并不是MAE和F-mesure。而他给的指标中只有NSS指标没有提升。
