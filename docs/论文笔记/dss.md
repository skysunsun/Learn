>   **短连接深度监督突出对象检测**

1.  针对问题

>   FCN模型没有显式处理尺度空间问题。整体嵌套边缘检测器(HED)为边缘检测和边界检测提供了一种具有深度监控的跳跃层结构，但HED对显著性检测的性能增益并不明显。但实验结果表明，该结构不适用于突出目标检测。造成这种现象的原因有两方面。一方面，需要均匀区域的显著性检测与需要特殊处理的边缘检测有很大的不同。一个好的显著性检测算法应该能够从图像中提取出最具有视觉特征的物体和区域，而不是简单的边缘信息。另一方面，较低阶生成的特征过于复杂，较深侧输出层得到的显著性映射缺乏规律性。较深的侧输出能够找到突出区域的位置，但以丢失细节为代价，而较浅的侧输出侧重于低层特性，但缺乏全局信息。

1.  提出模型

>   针对上述问题，我们提出了一种自顶向下的方法，将低层和高层特征合理地结合起来，实现精确的显著性检测。本文提出了一种新的突出目标检测方法，即在HED体系结构中引入跳层结构的短连接，我们的框架充分利用了从FCNs中提取的多级和多尺度特征，在每一层都提供了更高级的表示，这是执行段检测非常必要的属性。通过结合不同层次的特征，得到的体系结构在每一层都提供了丰富的多尺度特征映射，这本质上是进行有效的突出目标检测所必需的属性。

>   我们的架构在功能上可以看作是两个紧密相连的阶段，我们分别称之为显著性定位阶段和细节细化阶段。显著性定位阶段的主要任务是在给定的图像中寻找最显著的区域。对于细节细化阶段，我们引入了自顶向下的方法，即从较深的侧输出层到较浅的侧输出层的一系列短连接。

>   **基础架构：使用VGG-16作为基础骨架**

![](media/38357345d88c27cdec1e10cb198e1694.png)

>   **HED架构：**

>   HED分别将VGGNet各阶段的各边输出连接到最后一个卷积层，分别为conv1_2、conv2_2、conv3_3、conv4_3、conv5_3。每边输出由一个内核大小为1\*1的单通道卷积层和一个用于学习边缘信息的上采样层组成。

>   **侧边损失函数：**

>   在HED体系结构中，引入了5个侧输出，每个侧输出都直接连接到每个级的最后一个卷积层。我们将所有标准网络层参数集合表示为W，不失一般性，进一步假设有M个边输出。每个边的输出都与一个分类器相关联，其中对应的权值可以表示为w
>   = (w(1);w(2);...;w(M))。因此，HED的侧目标函数为：

![](media/20018053cac269526f6a363efe34b03e.png)

>   为第m侧输出损失权重，
>   为第m侧输出的图像级类平衡交叉熵损失函数。此外，还增加了权重融合层，以更好地捕捉每边输出的优点。融合层处的融合损失函数可以表示为

![](media/97916e509ead78516311a72d24fde7d3.png)

>   f = (f1;f2;...;fm)为各层融合权重。 为m侧输出激活函数， 表示sigmid函数，
>   表示预测值与真实值距离（图像级类平衡交叉熵损失函数）Z表示真值。

>   **最终损失函数：**

![](media/802881a9036f75091d5b1d7fc5280040.png)

>   **增强HED：**

>   我们扩展了用于突出目标检测的HED体系结构，我们将另一个侧输出连接到VGGNet中的最后一个池层(pool5)。此外，由于凸点目标检测比边缘检测更加困难，我们在每侧输出中增加了两个卷积层，每个卷积层具有不同的滤波通道和空间大小

![](media/67b795ee5617a2f587b0f70cac6b1292.png)

>   对于上采样，我们使用与HED相同的双线性插值操作。我们还使用了一个标准的交叉熵损失，并计算了训练图像X中所有像素点的损失函数;我们的损失函数可以定义如下

![](media/6cd384d32b6f018b73c7f0e4d0a99336.png)

>   式中 为第m边输出中j位置激活值的概率，由 计算，其中 为第m边输出的激活值。

![](media/e96ea6c67bf908fd3bccbd4a942c6760.png)

>   **短连接架构：**

![](media/2133c4c91f063a11a388f32c398bd1ba.png)

>   我们的新架构的主干是增强的HED，图5说明了如何构造从侧输出4到侧输出2的短连接。首先通过简单的双线性插值对侧输出3和侧输出4中的分数图进行上采样，然后将其与侧输出2中的原始分数图连接起来。根据上下文可以推导出双线性插值的超参数。

>   由于显著目标检测是一项与类无关的任务，我们进一步对前面图5中虚线包围框所包围的score
>   map进行加权，并引入另外的1\*1个卷积层作为侧输出2的新的score
>   map。对于连接到多个短连接的侧输出，也可以使用类似的方法。例如，让我们假设3个短连接连接到侧输出2。在虚线包围框中将有4个分数映射连接在一起。

![](media/a55e6939904558af21c7dfdfdab8d3a4.png)

>   其中 是侧边输出i到侧边输出m (i \>
>   m)的短连接的权值，我们可以直接将设置为0，去掉一些短连接。

![](media/0cf0c482150e71cf64b1f8f7bbbf1008.png)

>   使用了标准的交叉损失函数。

![](media/4f644cc475293a09e08a7987c6afa559.png)

>   最后的融合层：

![](media/f7b9eaf951625e3cf7db62ddf618d817.png)

>   然后取平均：

![](media/7b1ed045f50edec0b3b28f15d31a42bc.png)

>   **最终的模型框架：**

![](media/e0364b1bd61752371b05291158c7b46a.png)

>   **图像后处理：CRF**

![](media/8d469826c70db9034675272da565e793.png)

![](media/f67360788580060ad953d59c4499539b.png)

>   是 归一化显著性值， 为sigmid函数， 为尺度参数。

![](media/d34ab33ebb5ff97a14e926891d53205e.png)

>   如果 则 否则等于0， 分别为 的像素值和位置值

1.  效果

>   我们在5个代表性数据集上评估了我们的方法，包括MSRA-B、ECSSD、ku -
>   is、PASCALS和SOD。

>   考虑到所有情况，我们提出的方法不仅突出了正确的突出区域，而且产生了一致的边界。同样值得注意的是，由于连接时间较短，我们的方法给了突出区域更多的自信，突出的物体和背景之间产生了更高的对比度。更重要的是，它生成了连通区域，大大增强了我们模型的能力。这些优点使得我们的结果非常接近真实情况，因此在几乎所有情况下都优于其他方法。

>   该方法在HKUIS[47]、PASCALS[55]、SOD[56]、[57]等难度较大的数据集中表现得更好，这些数据集中包含大量具有多个突出对象的图像。这表明我们的方法能够检测和分割最突出的目标

>   在推理阶段，我们需要大约0.08秒的时间来处理一个大小为300
>   \*400的输入图像。考虑到CRF层，还需要0.4秒。因此，对于大小为300
>   400的图像，我们的总时间成本小于0.5s。

1.  优缺点

>   优点：

>   高级特征可以转换为较浅的侧输出层，从而帮助它们更好地定位最突出的区域，以及较浅的侧输出层可以学习丰富的低层特征，这些特征有助于从较深的侧输出层细化稀疏和不规则的预测图。

>   我们的方法是完全卷积的，不需要其他先验信息。

>   提出了一种用于突出目标检测的深度监督网络。我们引入了一系列浅侧和深侧输出层之间的短连接，而不是直接将损失层连接到每个阶段的最后一层。通过这些短连接，激活每一个侧输出层，既可以突出整个突出对象，又可以精确定位其边界。

>   全连通的CRF也被用于纠正错误的预测和进一步提高空间一致性。

>   缺点：

>   损失函数着实没看懂，侧边算一次交叉损失，融合又算一次交叉损失，

1.  凸点目标不能被完全分割出来，留下了凸点目标的一小部分。

2.  不能提取出突出物体的主体，或者预测出非突出区域为突出区域。

3.  虽然我们的方法可以检测出透明对象的某些部分，但是分割出完整的对象仍然是非常困难的。

4.  我还是觉模型大……………这个有6000W参数，而且效果还没NLDF好。

>   改进想法

1.  模型减小，短接似乎太多了。

2.  图形后处理用了CRF辅助，应该踢掉
